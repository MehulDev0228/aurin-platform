# üîó Aurin Blockchain Integration Guide

## Overview
This guide will walk you through integrating blockchain functionality into Aurin for minting NFT badges. **No blockchain knowledge required** - we'll use simple tools that handle everything for you.

---

## üéØ What We're Building

**Aurin NFT Badges System:**
- Users earn badges by attending events
- Badges are minted as NFTs on the blockchain
- NFTs prove ownership permanently
- Badges can be viewed/verified by anyone
- Users own their credentials forever

---

## üõ†Ô∏è Recommended Technology Stack

### Option 1: **thirdweb** (EASIEST - Recommended)
‚úÖ No blockchain knowledge needed
‚úÖ Dashboard for managing contracts
‚úÖ Free to start
‚úÖ Handles gas fees
‚úÖ React SDK available

### Option 2: **Crossmint**
‚úÖ Wallet abstraction (users don't need wallets)
‚úÖ Email-based wallets
‚úÖ Credit card payments for gas
‚úÖ Enterprise features

### Option 3: **Privy**
‚úÖ Embedded wallets
‚úÖ Social login
‚úÖ Email wallets
‚úÖ Great UX

**We'll use thirdweb in this guide** because it's the easiest for beginners.

---

## üìã Prerequisites

1. **Node.js** installed
2. **Aurin project** (you have this)
3. **Metamask wallet** (for testing) - [Download](https://metamask.io/)
4. **thirdweb account** - [Sign up free](https://thirdweb.com/)

---

## üöÄ Step-by-Step Integration

### STEP 1: Install thirdweb

\`\`\`bash
npm install @thirdweb-dev/sdk @thirdweb-dev/react ethers@5
\`\`\`

### STEP 2: Create Your NFT Contract

#### 2.1: Go to thirdweb Dashboard
1. Visit [thirdweb.com/dashboard](https://thirdweb.com/dashboard)
2. Click "Deploy new contract"
3. Choose "NFT Collection" (ERC-721)
4. Fill in:
   - **Name**: Aurin Badges
   - **Symbol**: BADGE
   - **Description**: Verified achievement badges
5. Choose **Base** network (Coinbase's L2 - cheap and fast)
6. Click "Deploy Now"

#### 2.2: Note Your Contract Address
After deployment, copy the contract address. It looks like:
\`0x1234567890abcdef1234567890abcdef12345678\`

Save this - you'll need it!

### STEP 3: Set Up Environment Variables

Add to your \`.env\` file:

\`\`\`env
# Blockchain Settings
VITE_THIRDWEB_CLIENT_ID=your_client_id_here
VITE_CONTRACT_ADDRESS=your_contract_address_here
VITE_CHAIN_ID=8453  # Base mainnet
\`\`\`

**Get your Client ID:**
1. Go to [thirdweb.com/dashboard/settings](https://thirdweb.com/dashboard/settings)
2. Click "API Keys"
3. Create new API key
4. Copy the Client ID

### STEP 4: Wrap Your App with thirdweb Provider

Update \`src/main.tsx\`:

\`\`\`typescript
import { ThirdwebProvider } from "@thirdweb-dev/react";
import { Base } from "@thirdweb-dev/chains";

ReactDOM.createRoot(document.getElementById('root')!).render(
  <React.StrictMode>
    <ThirdwebProvider
      activeChain={Base}
      clientId={import.meta.env.VITE_THIRDWEB_CLIENT_ID}
    >
      <App />
    </ThirdwebProvider>
  </React.StrictMode>
);
\`\`\`

### STEP 5: Update Wallet Connection

Replace the placeholder wallet connection in \`WalletConnect.tsx\`:

\`\`\`typescript
import { ConnectWallet, useAddress, useConnectionStatus } from "@thirdweb-dev/react";

export default function WalletConnect() {
  const address = useAddress();
  const connectionStatus = useConnectionStatus();

  // When connected, save to Supabase
  useEffect(() => {
    if (address && connectionStatus === "connected") {
      saveWalletConnection(address, "thirdweb");
    }
  }, [address, connectionStatus]);

  return (
    <div>
      <ConnectWallet />
    </div>
  );
}
\`\`\`

### STEP 6: Create Badge Minting Service

Create \`src/lib/blockchain.ts\`:

\`\`\`typescript
import { ThirdwebSDK } from "@thirdweb-dev/sdk";
import { Base } from "@thirdweb-dev/chains";

const sdk = new ThirdwebSDK(Base, {
  clientId: import.meta.env.VITE_THIRDWEB_CLIENT_ID,
});

export async function mintBadgeNFT(
  recipientAddress: string,
  badgeName: string,
  badgeDescription: string,
  badgeImageUrl: string
) {
  try {
    const contract = await sdk.getContract(
      import.meta.env.VITE_CONTRACT_ADDRESS,
      "nft-collection"
    );

    const tx = await contract.mintTo(recipientAddress, {
      name: badgeName,
      description: badgeDescription,
      image: badgeImageUrl,
    });

    return {
      success: true,
      transactionHash: tx.receipt.transactionHash,
      tokenId: tx.id.toString(),
    };
  } catch (error) {
    console.error("Minting error:", error);
    return { success: false, error };
  }
}

export async function verifyBadgeOwnership(
  walletAddress: string,
  tokenId: string
) {
  try {
    const contract = await sdk.getContract(
      import.meta.env.VITE_CONTRACT_ADDRESS
    );

    const owner = await contract.ownerOf(tokenId);
    return owner.toLowerCase() === walletAddress.toLowerCase();
  } catch (error) {
    return false;
  }
}
\`\`\`

### STEP 7: Integrate Minting When Organizers Issue Badges

Update \`src/lib/eventQueries.ts\`:

\`\`\`typescript
import { mintBadgeNFT } from './blockchain';

export async function issueBadgeToAttendee(
  enrollmentId: string,
  badgeId: string,
  userId: string
) {
  // 1. Get badge and user data
  const { data: badge } = await supabase
    .from('badges')
    .select('name, description, image_url')
    .eq('id', badgeId)
    .single();

  const { data: profile } = await supabase
    .from('profiles')
    .select('blockchain_address')
    .eq('id', userId)
    .single();

  if (!badge || !profile?.blockchain_address) {
    throw new Error('Missing badge or wallet info');
  }

  // 2. Mint NFT on blockchain
  const mintResult = await mintBadgeNFT(
    profile.blockchain_address,
    badge.name,
    badge.description,
    badge.image_url
  );

  if (!mintResult.success) {
    throw new Error('Failed to mint NFT');
  }

  // 3. Save to database
  const { data: achievement, error } = await supabase
    .from('achievements')
    .insert({
      user_id: userId,
      badge_id: badgeId,
      blockchain_verified: true,
      nft_minted: true,
      token_id: mintResult.tokenId,
      mint_transaction_hash: mintResult.transactionHash,
      blockchain_network: 'base',
    })
    .select()
    .single();

  if (error) throw error;

  // 4. Update enrollment
  await supabase
    .from('event_enrollments')
    .update({
      badge_issued: true,
      status: 'completed',
    })
    .eq('id', enrollmentId);

  return achievement;
}
\`\`\`

### STEP 8: Display NFTs on Profile

Users can view their NFTs on:
- Aurin dashboard (from database)
- OpenSea: \`https://opensea.io/{walletAddress}\`
- thirdweb dashboard

---

## üí∞ Costs & Gas Fees

### Development (Testnet - FREE)
- Use Base Sepolia testnet
- Get free test tokens from [faucet](https://www.coinbase.com/faucets/base-ethereum-goerli-faucet)
- Test everything for free

### Production (Mainnet)
**Base Network Costs:**
- Minting 1 NFT: ~$0.01 USD
- Transferring NFT: ~$0.01 USD
- Very affordable!

**Who Pays Gas?**
- **Option A**: Platform pays (you cover costs)
- **Option B**: Users pay (they cover their own mints)
- **Option C**: Hybrid (free for first X badges, then user pays)

**Recommended**: Platform pays initially. At $0.01 per badge, even 10,000 badges = $100.

---

## üîí Security Best Practices

1. **Never expose private keys**
   - Use thirdweb's managed wallets
   - Store admin keys in environment variables
   - Never commit keys to Git

2. **Rate limiting**
   - Prevent spam minting
   - Add cooldown periods

3. **Verification**
   - Only mint after event completion verified
   - Check user hasn't already received badge
   - Validate organizer permissions

4. **Monitoring**
   - Track all mints in database
   - Set up alerts for suspicious activity
   - Monitor contract on [Basescan](https://basescan.org/)

---

## üß™ Testing

### Test on Sepolia (Testnet) First

1. Switch contract to Base Sepolia
2. Get test ETH from faucet
3. Test full flow:
   - User signs up
   - Connects wallet
   - Attends event
   - Receives NFT
   - Views on OpenSea testnet

### Once Working
1. Deploy production contract on Base mainnet
2. Update environment variables
3. Fund admin wallet with ETH for gas
4. Launch!

---

## üìä Monitoring Your NFTs

### thirdweb Dashboard
- See all minted badges
- Track owners
- View transactions
- Manage contract

### Basescan
- Verify contract: \`https://basescan.org/address/{contractAddress}\`
- Track transactions
- Public transparency

### OpenSea
- Users can list/trade badges (if you enable trading)
- View collection page
- Track floor price

---

## üéØ Quick Start Checklist

- [ ] Install thirdweb packages
- [ ] Create thirdweb account
- [ ] Deploy NFT contract on Base
- [ ] Get Client ID
- [ ] Add to .env file
- [ ] Update main.tsx with provider
- [ ] Replace wallet connection code
- [ ] Create blockchain.ts service
- [ ] Update badge issuing function
- [ ] Test on Sepolia testnet
- [ ] Deploy to production!

---

## üÜò Troubleshooting

### "Wallet not connected"
- Check ThirdwebProvider is wrapping app
- Verify Client ID is correct
- Check user has wallet connected

### "Insufficient funds"
- Need ETH on Base network for gas
- Fund admin wallet
- Or use thirdweb's gasless transactions

### "Transaction failed"
- Check contract address is correct
- Verify network is Base
- Ensure proper permissions

### "NFT not showing"
- Wait 1-2 minutes for blockchain confirmation
- Check Basescan for transaction
- Verify token ID in database matches blockchain

---

## üìö Additional Resources

- [thirdweb Docs](https://portal.thirdweb.com/)
- [Base Network Docs](https://docs.base.org/)
- [OpenSea Guide](https://docs.opensea.io/)
- [Web3 Glossary](https://ethereum.org/en/glossary/)

---

## üí° Pro Tips

1. **Start Simple**: Deploy to testnet first, test everything
2. **Batch Minting**: Mint multiple badges in one transaction to save gas
3. **Metadata**: Use IPFS for badge images (permanent storage)
4. **Analytics**: Track which badges are most popular
5. **Community**: Let users showcase NFTs on Twitter with auto-generated images

---

## üéâ You're Ready!

With this setup, Aurin will have a production-ready blockchain-verified badge system. Users get permanent proof of their achievements, and you leverage the security of blockchain without needing to be a crypto expert.

**Questions?** Check thirdweb Discord or Aurin's documentation.

**Now go build the 4th line on every resume! üöÄ**
